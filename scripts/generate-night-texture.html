<!DOCTYPE html>
<html>
<head>
    <title>Generate Night Texture</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #222;
            color: white;
        }
        canvas {
            border: 1px solid #666;
            margin: 10px 0;
        }
        .controls {
            margin: 20px 0;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #45a049;
        }
    </style>
</head>
<body>
    <h1>Night Texture Generator</h1>
    <p>Generate a procedural night texture with city lights for the globe.</p>
    
    <div class="controls">
        <label>Width: <input type="number" id="width" value="2048" min="256" max="4096"></label>
        <label>Height: <input type="number" id="height" value="1024" min="128" max="2048"></label>
        <label>City Density: <input type="range" id="density" min="0.1" max="5" step="0.1" value="1"></label>
        <label>Light Intensity: <input type="range" id="intensity" min="0.1" max="2" step="0.1" value="0.8"></label>
        <button onclick="generateTexture()">Generate Texture</button>
        <button onclick="downloadTexture()">Download PNG</button>
    </div>
    
    <canvas id="canvas"></canvas>
    
    <script>
        let canvas, ctx;
        
        function init() {
            canvas = document.getElementById('canvas');
            ctx = canvas.getContext('2d');
            generateTexture();
        }
        
        function generateTexture() {
            const width = parseInt(document.getElementById('width').value);
            const height = parseInt(document.getElementById('height').value);
            const density = parseFloat(document.getElementById('density').value);
            const intensity = parseFloat(document.getElementById('intensity').value);
            
            canvas.width = width;
            canvas.height = height;
            
            // Fill with black background
            ctx.fillStyle = 'black';
            ctx.fillRect(0, 0, width, height);
            
            // Generate city lights based on realistic population distribution
            generateCityLights(width, height, density, intensity);
            
            console.log(`Generated ${width}x${height} night texture`);
        }
        
        function generateCityLights(width, height, density, intensity) {
            // Major population centers (approximate coordinates)
            const cities = [
                // Asia
                { x: 0.77, y: 0.35, size: 0.8, name: 'Tokyo' },
                { x: 0.78, y: 0.4, size: 0.7, name: 'Beijing' },
                { x: 0.8, y: 0.45, size: 0.6, name: 'Shanghai' },
                { x: 0.72, y: 0.52, size: 0.5, name: 'Mumbai' },
                { x: 0.75, y: 0.55, size: 0.4, name: 'Delhi' },
                
                // Europe
                { x: 0.52, y: 0.32, size: 0.5, name: 'London' },
                { x: 0.54, y: 0.33, size: 0.4, name: 'Paris' },
                { x: 0.56, y: 0.33, size: 0.4, name: 'Berlin' },
                { x: 0.58, y: 0.38, size: 0.3, name: 'Rome' },
                
                // North America
                { x: 0.22, y: 0.35, size: 0.6, name: 'New York' },
                { x: 0.18, y: 0.4, size: 0.5, name: 'Los Angeles' },
                { x: 0.2, y: 0.37, size: 0.4, name: 'Chicago' },
                
                // South America
                { x: 0.32, y: 0.7, size: 0.4, name: 'SÃ£o Paulo' },
                { x: 0.34, y: 0.68, size: 0.3, name: 'Rio de Janeiro' },
                
                // Africa
                { x: 0.53, y: 0.65, size: 0.3, name: 'Lagos' },
                { x: 0.55, y: 0.7, size: 0.2, name: 'Cairo' },
                
                // Australia
                { x: 0.85, y: 0.8, size: 0.3, name: 'Sydney' }
            ];
            
            // Draw major cities
            cities.forEach(city => {
                const x = city.x * width;
                const y = city.y * height;
                const baseRadius = city.size * 50 * density;
                
                drawCityCluster(x, y, baseRadius, intensity);
            });
            
            // Add random smaller settlements
            const numSmallCities = Math.floor(width * height * density * 0.0001);
            for (let i = 0; i < numSmallCities; i++) {
                const x = Math.random() * width;
                const y = Math.random() * height;
                
                // Avoid polar regions and oceans (simplified)
                if (y < height * 0.1 || y > height * 0.9) continue;
                
                const radius = Math.random() * 10 + 2;
                drawCityCluster(x, y, radius, intensity * 0.5);
            }
        }
        
        function drawCityCluster(centerX, centerY, radius, intensity) {
            const numLights = Math.floor(radius * radius * 0.1);
            
            for (let i = 0; i < numLights; i++) {
                // Random position within cluster
                const angle = Math.random() * Math.PI * 2;
                const distance = Math.random() * radius;
                const x = centerX + Math.cos(angle) * distance;
                const y = centerY + Math.sin(angle) * distance;
                
                // Random light properties
                const lightRadius = Math.random() * 3 + 1;
                const brightness = (Math.random() * 0.5 + 0.5) * intensity;
                
                // Create gradient for glow effect
                const gradient = ctx.createRadialGradient(x, y, 0, x, y, lightRadius * 2);
                
                // Warm city light colors
                const colors = [
                    `rgba(255, 240, 180, ${brightness})`,
                    `rgba(255, 220, 160, ${brightness})`,
                    `rgba(255, 200, 140, ${brightness})`,
                    `rgba(240, 240, 255, ${brightness * 0.8})` // Some cooler lights
                ];
                
                const color = colors[Math.floor(Math.random() * colors.length)];
                gradient.addColorStop(0, color);
                gradient.addColorStop(0.5, color.replace(/[\d\.]+\)$/, `${brightness * 0.5})`));
                gradient.addColorStop(1, 'rgba(255, 240, 180, 0)');
                
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(x, y, lightRadius * 2, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        function downloadTexture() {
            const link = document.createElement('a');
            link.download = 'night-texture.png';
            link.href = canvas.toDataURL();
            link.click();
        }
        
        // Initialize when page loads
        window.onload = init;
    </script>
</body>
</html>